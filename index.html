<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel - Create User</title>
</head>
<body>
  <h2>Create User Account</h2>

  <input id="username" placeholder="Username"><br><br>
  <input id="password" placeholder="Password" type="password"><br><br>
  <label>Expiry Date:</label>
  <input id="expiry" type="date"><br><br>
  <label>Device Limit:</label>
  <input id="devices" type="number" value="1" min="1"><br><br>

  <button id="btn">Create</button>

  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDssixgarRWvLMKtUsX7HLEt8uPGmNIRak",
      authDomain: "iptv-login-3204b.firebaseapp.com",
      databaseURL: "https://iptv-login-3204b-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "iptv-login-3204b",
      storageBucket: "iptv-login-3204b.appspot.com",
      messagingSenderId: "464216999882",
      appId: "1:464216999882:web:d7e1f7d44adacd8b46b133"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    document.getElementById("btn").onclick = () => {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const expiry = document.getElementById("expiry").value;
      const devices = parseInt(document.getElementById("devices").value);

      if (!username || !password || !expiry || isNaN(devices)) {
        alert("⚠️ Please fill out all fields correctly.");
        return;
      }

      const payload = {
        password: password,
        expiration: expiry,
        device_limit: devices,
        status: "active",
        created_at: new Date().toISOString()
      };

      db.ref('users/' + username).set(payload).then(() => {
        alert("✅ User '" + username + "' created successfully!");
      }).catch(err => {
        alert("❌ Error: " + err.message);
        console.error(err);
      });
    };
  </script>
</body>
</html>
